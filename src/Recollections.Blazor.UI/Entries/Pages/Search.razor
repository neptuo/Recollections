@page "/search"
@inherits UserStateAuthenticatedComponentBase

<DocumentTitle Value="Search" />

<div class="search">
    <form @onsubmit="@(() => { Navigator.OpenSearch(SearchText); StateHasChanged(); })">
        <div class="row my-4">
            <div class="col-md col-sm-12">
                <input class="form-control" type="text" placeholder="Search phrase..." @bind="SearchText" />
            </div>
            <div class="col-md-auto col-sm-12 mt-2 mt-md-0">
                <button class="btn btn-primary d-block w-100">
                    <Icon Identifier="search" />
                    Search
                </button>
            </div>
        </div>
    </form>

    <div class="row">
        <ListView Items="@Items" IsLoading="@(Items.Count == 0 && IsLoading)" EmptyMessage="@EmptyMessage" Context="entry">
            <EmptyContent>
                <div class="col-12">
                    <Alert Mode="@AlertMode.Warning" Message="@EmptyMessage" />
                </div>
            </EmptyContent>
            <ChildContent>
                <div class="col-sm-12 mb-4">
                    <SearchEntryCard Model="entry" CardCssClass="h-100" OnCardClick="() => Navigator.OpenEntryDetail(entry.Id)" />
                </div>

                @if (Items.IndexOf(entry) == Items.Count - 3 && HasMore)
                {
                    <AutoloadNext Intersected="@LoadMoreAsync" />
                }
            </ChildContent>
        </ListView>
    </div>
</div>