<form @ref="FormElement" class="inline-form file-upload" action="@Url">
    <input type="file" multiple />
    <button type="button" class="btn btn-sm btn-primary">
        <Icon Identifier="image" />
        @Text
    </button>
</form>


<Modal @ref="@UploadError" Title="Upload Error">
    <ChildContent>
        @{
            var message = $"Some uploads ({UploadErrors.Count}) finished with errors.";
        }
        <Alert Mode="AlertMode.Warning" Message="@message" />

        <table class="table table-sm table-hover">
            <thead>
                <tr>
                    <th scope="col">File</th>
                    <th scope="col">Error</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var error in UploadErrors)
                {
                    <tr>
                        <td>
                            @error.Name
                        </td>
                        <td>
                            @error.ErrorDescription (@error.StatusCode)
                        </td>
                    </tr>
                }
            </tbody>
        </table>

    </ChildContent>
    <Buttons>
        <button class="btn btn-primary btn-sm" @onclick="@(() => { UploadError.Hide(); return FileUploader.RetryEntityQueueAsync(EntityType, EntityId); })">Retry</button>
        <button class="btn btn-secondary btn-sm" @onclick="@(() => { UploadError.Hide(); return FileUploader.ClearEntityQueueAsync(EntityType, EntityId); })">
            <Icon Identifier="trash-alt" CssClass="me-1" />
            Remove all
        </button>
    </Buttons>
</Modal>
<Modal @ref="@UploadRetryModal" Title="Files from last time to retry">
    <ChildContent>
        <Alert Mode="AlertMode.Warning" Message="@($"Some uploads ({UploadsToRetry.Count}) did not finished last time.")" />

        <table class="table table-sm table-hover">
            <thead>
                <tr>
                    <th scope="col">File</th>
                    <th scope="col">Size</th>
                    <td></td>
                </tr>
            </thead>
            <tbody>
                @foreach (var retry in UploadsToRetry)
                {
                    var item = retry;
                    <tr>
                        <td>
                            @retry.Name
                        </td>
                        <td>
                            @retry.Size
                        </td>
                        <td style="width: 1%">
                            <Icon Identifier="trash-alt" OnClick="@(() => DeleteUploadToRetryAsync(item))" CssClass="text-danger" />
                        </td>
                    </tr>
                }
            </tbody>
        </table>

    </ChildContent>
    <Buttons>
        <button class="btn btn-primary btn-sm" @onclick="@(() => { UploadRetryModal.Hide(); return FileUploader.RetryEntityQueueAsync(EntityType, EntityId); })">Retry</button>
        <button class="btn btn-secondary btn-sm" @onclick="@(() => { UploadRetryModal.Hide(); UploadsToRetry.Clear(); return FileUploader.ClearEntityQueueAsync(EntityType, EntityId); })">
            <Icon Identifier="trash-alt" CssClass="me-1" />
            Remove all
        </button>
    </Buttons>
</Modal>